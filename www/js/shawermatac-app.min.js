function temp(templateId){var templateHtml=$$(templateId).html(),template=Template7.compile(templateHtml);return template}function getLang(language){$$.getJSON("js/lang-"+language+".json",function(data){lang=data;var indexHtml=Template7.templates.IndexTemplate(lang);$$(".indexBtns").html(indexHtml),$$.each(lang.monthnames,function(i,month){monthNames.push(month)})})}function showMessage(options,timetoclose){var defaults={type:"success",icon:"icon-success",content:"content",haslink:!1,href:"",linkText:""};options=options||{};for(var def in defaults)("undefined"==typeof options[def]||null===options[def])&&(options[def]=defaults[def]);("undefined"==typeof timetoclose||null===timetoclose)&&(timetoclose=2e3);var messageHtml=Template7.templates.messagestemplate(options);myApp.popup(messageHtml),setTimeout(function(){myApp.closeModal("#messages-popup")},timetoclose)}function imgError(image){return image.onerror="",image.src="img/noimage.jpg",!0}function setlogin(){localStorage.setItem("islogin","yes"),localStorage.setItem("user",USERNAME),localStorage.setItem("pass",PASSWORD);try{callNoti(api_url)}catch(e){}}function setlogout(){localStorage.removeItem("islogin"),localStorage.removeItem("user"),localStorage.removeItem("pass")}function validateEmail(input){var regex=/^[-a-z0-9~!$%^&*_=+}{\'?]+(\.[-a-z0-9~!$%^&*_=+}{\'?]+)*@([a-z0-9_][-a-z0-9_]*(\.[-a-z0-9_]+)*\.(aero|arpa|biz|com|coop|edu|gov|info|int|mil|museum|name|net|org|pro|travel|mobi|[a-z][a-z])|([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}))(:[0-9]{1,5})?$/i,emailID=input.val();if(!emailID.match(regex)){var actionHtml=[{text:lang.errorMail,label:!0,color:"red"}];return myApp.actions(input,actionHtml),!1}return!0}function phonenumber(input){var phoneno=/^[\(\)\s\-\+\d]{8,17}$/,phone=input.val();if(!phone.match(phoneno)){var actionHtml=[{text:lang.errorPhone,label:!0,color:"red"}];return myApp.actions(input,actionHtml),!1}return!0}function checkPassword(input){var pwd=input.val();if(!pwd.match(/^[0-9a-zA-Z]{8,20}$/)){var actionHtml=[{text:lang.errorPassword,label:!0,color:"red"}];return myApp.actions(input,actionHtml),!1}return!0}function checkTime(input){re=/^(\d{1,2}):(\d{2})([ap]m)?$/;var pwd=input.val();if(!pwd.match(re)||""==pwd){var actionHtml=[{text:lang.errorTime,label:!0,color:"red"}];myApp.actions(input,actionHtml)}}function checkDate(input){re=/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/;var pwd=input.val();if(!pwd.match(re)||""==pwd){var actionHtml=[{text:lang.errorDate,label:!0,color:"red"}];myApp.actions(input,actionHtml)}}function checkName(input){var pwd=input.val();if(!pwd.match(/^([^\s]){2,50}$/)){var actionHtml=[{text:lang.errorText,label:!0,color:"red"}];return myApp.actions(input,actionHtml),!1}return!0}function getSlider(){homeslider=new myApp.swiper(".page .home-slider",{speed:400,spaceBetween:20,paginationHide:!1,preventClicks:!1,breakpoints:{320:{slidesPerView:1},480:{slidesPerView:1},640:{slidesPerView:2}}}),slides.length>0?($$.each(slides,function(i,item){var slideritems=sliderTemplate(item);homeslider.appendSlide(slideritems)}),$$(".slide-link").click(function(){slideId=$$(this).attr("id"),getOffer(slideId)})):$$.getJSON(api_url+"misc/slider",function(data){slides=data,$$.each(slides,function(i,item){var slideritems=sliderTemplate(item);homeslider.appendSlide(slideritems)}),$$(".slide-link").click(function(){slideId=$$(this).attr("id"),getOffer(slideId)})})}function hw(){var $this=$$(".btns-list ul li a"),widt=Math.floor($this.width())+"px";$this.css("height",widt)}function getOffer(id){var opj;$$.each(slides,function(i,item){item.id==id&&(opj=item)});var offertemplate=$$("#offer_details").html(),offerhtml=Template7.compile(offertemplate)(opj);myApp.popup(offerhtml),initOffer()}function initOffer(){$$(".popup-offer").on("opened",function(){calculateBadge(),$$(".btn-incart").click(function(){cardID=$$(this).data("id"),offerToCard(cardID),calculateBadge(),myApp.addNotification({title:lang.noti_thanks,message:lang.noti_addcart,closeOnClick:!0}),setTimeout(function(){myApp.closeNotification(".notifications")},1e3)})})}function getAddresses(callback){$$.getJSON(api_url+"member/addresses",function(data){user_adrs=data,callback&&placesTem(data)})}function getBranches(callback){branches.length<=0&&$$.getJSON(api_url+"misc/branches",function(data){branches=data,$$.each(branches,function(i,branch){namesList.push(branch.city)}),branchesCities=$$.unique(namesList),callback&&($$.each(branches,function(i,item){var branchesList=branchTemplate(item);$$("#branchesList").append(branchesList)}),myApp.swipeoutOpen($$("li.swipeout:first-child")),setTimeout(function(){myApp.swipeoutClose($$("li.swipeout:first-child"))},1500))})}function openMap(x,y){window.open("geo:"+x+","+y+"?q="+x+","+y)}function Scroll(){myScroll=new IScroll(".div-scroller",{scrollX:!0,scrollY:!1,mouseWheel:!0,eventPassthrough:!0})}function menuList(callback){myApp.showProgressbar("body","red"),$$.getJSON(api_url+"menu/menu",function(data){menuCategories=data,callback&&makeMenu(data)})}function makeMenu(categories){var sortCategory=[],CategoryID=[];$$.each(categories,function(i,category){var genMenu=MenuTemplate(category);$$("#menu-tabs").append(genMenu),sortCategory.push(category.name),CategoryID.push(category.id),$$("#scroller li:first-child a,#menu-tabs .tab:first-child").addClass("active"),$$.each(category.items,function(j,item){item.yummy="yes"==localStorage.getItem("yummy-"+item.id),item.yummy&&$$('.card[id="'+item.id+'"]').find("a.btn-addyummy").addClass("done-add")}),myApp.hideProgressbar()});var mySwiper=myApp.swiper(".menu-slider",{pagination:"#scroller ul  ",bulletClass:"test",bulletActiveClass:"active",spaceBetween:50,paginationHide:!1,paginationClickable:!0,paginationBulletRender:function(index,className){return' <li class="'+className+" item-"+index+'"><a href="#" data-id="'+CategoryID[index]+'">'+sortCategory[index]+"</a></li>"}});mySwiper.on("SlideChangeEnd",function(){var x=-125*Math.max(0,mySwiper.activeIndex-1);mySwiper.activeIndex==menuCategories.length-1&&(x+=100),myScroll.scrollTo(x,0,350,IScroll.utils.ease.circular)}),$$(".btn-addyummy").click(function(){var id=$$(this).parents(".card").attr("id");$$(this).hasClass("done-add")?localStorage.removeItem("yummy-"+id,"no"):localStorage.setItem("yummy-"+id,"yes"),$$(this).toggleClass("done-add")}),$$("#menu-tabs .countplus").click(function(){var pageName=mainView.activePage.name,card=$$(this).parents(".item-card"),cardId=card.attr("id");increaseCard(cardId,pageName)}),$$("#menu-tabs .countminus").click(function(){var pageName=mainView.activePage.name,card=$$(this).parents(".item-card"),cardId=card.attr("id");decreaseCard(cardId,pageName)}),$$("#menu-tabs .countcancel").click(function(){var card=$$(this).parents(".item-card"),cardId=card.attr("id");card.toggleClass("opencard"),removeCard(cardId),calculateCancel(card),showCalculate(card),badgeCounter()}),$$(".calculate").click(function(){myApp.addNotification({title:lang.noti_thanks,message:lang.noti_addcart,closeOnClick:!0,media:'<img width="34" height="30" src="img/small-logo.png">',additionalClass:"menuNotifiction"}),setTimeout(function(){myApp.closeNotification(".notifications")},2500);var card=$$(this).parents(".item-card");card.toggleClass("opencard"),addToCard(card.attr("id"),card),showCalculate(card),badgeCounter(!0)})}function badgeCounter(plus){var badge=$$(".badgeCounter"),badge_cont=parseInt(badge.text());if(plus)$$(".badgeCounter").text(badge_cont+1);else{if(1>badge_cont)return;$$(".badgeCounter").text(badge_cont-1)}}function calculateBadge(){var count=$$(".cart-list").children("li:not(.deleting)").length;0==count&&$$.each(menuCategories,function(i,category){$$.each(category.items,function(j,item){item.in_cart&&count++})}),$$(".badgeCounter").html(count)}function showCalculate(card){card.find(".normal-btns").toggleClass("hide"),card.find(".prod-info").toggleClass("hide"),card.find(".card-footer").toggleClass("openfooter")}function getItem(id){for(var i=0;i<menuCategories.length;i++)for(var j=0;j<menuCategories[i].items.length;j++)if(item=menuCategories[i].items[j],item.id==id)return item;return{}}function addToCard(id,card){var item=getItem(id);item.in_cart=!0,item.qty=1,item.total=item.qty*item.price,card.find(".item-number").text(item.qty),card.find(".item-total").text(item.total),card.find(".item-counter").val(item.qty)}function offerToCard(id){var item=getItem(id);item.in_cart=!0,item.qty=1}function removeCard(id){var item=getItem(id);item.in_cart=!1,item.total=0,item.qty=1}function calculateCancel(card){for(var counter=$$(card).find(".item-counter"),number=$$(card).find(".item-number"),total=($$(card).find(".item-price"),$$(card).find(".item-total")),id=$$(card).attr("id"),i=0;i<menuCategories.length;i++)for(var x=0;x<menuCategories[i].items.length;x++)if(menuCategories[i].items[x].id==id){var pro_count=menuCategories[i].items[x].count,pro_total=(menuCategories[i].items[x].price,menuCategories[i].items[x].total);break}counter.val(pro_count),number.text(pro_count),total.text(pro_total)}function totalcart(){sum=0;$$("li.swipeout:not(.deleting) .item-total").each(function(i,j){sum+=parseInt($$(j).text())});$$(".total-cart").text(sum)}function increaseCard(id,pageName){var item=getItem(id),card=$$('[data-page="'+pageName+'"]  [id="'+id+'"]');item.in_cart=!0,item.qty+=1,item.total=item.qty*item.price,card.find(".item-number").text(item.qty),card.find(".item-total").text(item.total),card.find(".item-counter").val(item.qty)}function decreaseCard(id,pageName){var item=getItem(id),card=$$('[data-page="'+pageName+'"]  [id="'+id+'"]');item.qty>1&&(item.qty-=1,item.total=item.qty*item.price,card.find(".item-number").text(item.qty),card.find(".item-total").text(item.total),card.find(".item-counter").val(item.qty))}function selectBranch(){branches.length<=0?$$.getJSON(api_url+"misc/branches",function(data){branches=data,$$.each(branches,function(i,branch){namesList.push(branch.city)}),branchesCities=$$.unique(namesList),makeSelect(branches,branchesCities)}):makeSelect(branches,branchesCities)}function getbranches(branch){$$("#select_branch select option").remove(),$$.each(branches,function(i,v){if(v.city==branch){var select='<option value="'+v.id+'">'+v.name_en.replace(/-/g," ")+"</option>";$$("#select_branch select").append(select)}})}function makeSelect(branches,branchesCities){$$.each(branchesCities,function(i,v){var select='<option value="'+v+'">'+v+"</option>";$$("#select_city select").append(select)});var branch=$$("#select_city select").val();getbranches(branch),$$("#select_city select").change(function(){$$("#select_branch select option").remove();var branch=$$(this).val();getbranches(branch)})}function requestOrder(order,branch_id,date,time,or_note){var or_data={branchId:branch_id,or_date:date,or_time:time,or_note:or_note,items:order},brh=[];$$.each(branches,function(i,branch){branch.id==branch_id&&brh.push(branch)}),$$.post(api_url+"orders/make",or_data,function(data){var opj={order:JSON.parse(data).or_number,name:JSON.parse(data).branch.name_en,phone:JSON.parse(data).branch.phone},requesttemplate=$$("#request_details").html(),requesthtml=Template7.compile(requesttemplate)(opj);myApp.popup(requesthtml),$$(".request-btn").click(function(){mainView.router.load({url:"myorders.html",animatePages:!1}),setTimeout(function(){myApp.closeModal(".popup-request")},1e3)})})}function getCurrentOrder(){$$.each(menuCategories,function(i,category){$$.each(category.items,function(j,item){item.in_cart&&(card_items.push(item),item.in_cart=!1)})})}function getOrders(){myApp.showProgressbar(),$$.getJSON(api_url+"orders/list",function(data){or_details=data,makeOrdersList(or_details)})}function makeOrdersList(or_details){$$.each(or_details,function(i,order){var or_Card=ordertemplate(order);$$("#myorders").append(or_Card)}),myApp.hideProgressbar(),$$(".link-more").click(function(){var cardID=$$(this).parents(".card").attr("id");$$.each(or_details,function(i,items){items.or_id==cardID&&(opj=items,$$.each(opj.details,function(x,v){itemslist.push(v)}))});var ordertemplate=$$("#order_details").html(),orderhtml=Template7.compile(ordertemplate)(opj);myApp.popup(orderhtml)})}function getYummyList(){myApp.showProgressbar("body","red"),0==Object.keys(menuCategories).length?$$.getJSON(api_url+"menu/menu",function(data){menuCategories=data,makeYummyList(menuCategories)}):makeYummyList(menuCategories)}function makeYummyList(menuCategories){var emptymessage={yummy_content:lang.yum_con,yummy_link:lang.yum_lin,href:"menu.html"},emptytemplate=$$("#emptyYuummyTemplate").html(),emptyhtml=Template7.compile(emptytemplate)(emptymessage);$$.each(menuCategories,function(i,category){$$.each(category.items,function(j,item){if(item.yummy="yes"==localStorage.getItem("yummy-"+item.id),item.yummy){var yummy_list=yummyTemplate(item);$$("#yummy_list").append(yummy_list)}})});var childlength=$$(".content-block").children(".yummy-card").length;0==childlength&&$$("#emptyYuummy").html(emptyhtml),myApp.hideProgressbar(),$$(".yummy-card .countplus").click(function(){var pageName=mainView.activePage.name,card=$$(this).parents(".item-card"),cardId=card.attr("id");increaseCard(cardId,pageName)}),$$(".yummy-card .countminus").click(function(){var pageName=mainView.activePage.name,card=$$(this).parents(".item-card"),cardId=card.attr("id");decreaseCard(cardId,pageName)}),$$(".countcancel").click(function(){var card=$$(this).parents(".item-card");calculateCancel(card),showCalculate(card),badgeCounter()}),$$(".calculate").click(function(){var card=$$(this).parents(".item-card");addToCard(card.attr("id"),card),card.find(".item-counter").val(1),showCalculate(card),badgeCounter(!0),card.toggleClass("opencard")})}var api_url="http://www.shawermatac.com/api2/api/",myApp=new Framework7({init:!1,cache:!1,template7Pages:!0,swipeBackPage:!0,uniqueHistory:!0,precompileTemplates:!0,hideNavbarOnPageScroll:!1,showBarsOnPageScrollEnd:!1,tapHold:!0,onAjaxStart:function(xhr){myApp.showIndicator()},onAjaxComplete:function(xhr){myApp.hideIndicator()}}),$$=Dom7,menuCategories={},USERNAME,PASSWORD,lang={},slides=[],formA,formB,formC,addrssData={},branches=[],branche_city=[],namesList=[],branchesCities=[],user_adrs=[],total_cart,monthNames=[],daysNames=[],reqorder_date,card_items=[],itemslist=[],or_details={},mainView=myApp.addView(".view-main",{dynamicNavbar:!0,domCache:!1});Template7.registerHelper("js_compare",function(condition,options){"function"==typeof condition&&(condition=condition.call(this)),condition?options.fn(this,options.data):options.inverse(this,options.data)}),Template7.registerHelper("rating",function(star){for(var rating="";star>0;)rating+='<i class="icon icon-star" id=""></i>',star--;return rating});var branchTemplate=temp("#branch-list-template"),sliderTemplate=temp("#slider-template"),HeaderTemplate=temp("#menu-group-header-template"),MenuTemplate=temp("#menu-group-container-template"),cardTemplate=temp("#cart-list-template"),yummyTemplate=temp("#yummy-list-template"),ordertemplate=temp("#ordertemplate"),placeTemplate=temp("#myplaces-list-template");getLang("en"),$$.ajaxSetup({xhrFields:{withCredentials:!1},crossDomain:!0,beforeSend:function(xhr){xhr.setRequestHeader("Authorization","Basic "+btoa(localStorage.getItem("user")+":"+localStorage.getItem("pass")))}}),$$(document).on("ajaxStart",function(e){myApp.showIndicator()}).on("ajaxComplete",function(){myApp.hideIndicator()}).on("ajaxError",function(e){var xhr=e.detail.xhr,pageName=mainView.activePage.name;switch(pageName){case"signup":myApp.alert(lang.loginErrorText,lang.loginErrorTitle);break;case"signup-form_C":showMessage({type:"info",icon:"icon-info",content:JSON.parse(xhr.responseText).error},3e3);break;case"profile":showMessage({type:"info",icon:"icon-info",content:JSON.parse(xhr.responseText).error},2e3);break;case"form-page":showMessage({type:"danger",icon:"icon-danger",content:lang.plc_error},2e3);break;case"to-branch-place":showMessage({type:"info",icon:"icon-info",content:lang.brch_error},2e3);break;default:myApp.alert(lang.error,xhr.status)}}),$$(document).once("pageBeforeInit",'.page[data-page="index"]',function(page){myApp.mainView.history=[],mainView.router.load({template:Template7.templates.loginTemplate,animatePages:!1}),$$(".page.page-on-left").remove(),$$(".navbar-inner.navbar-on-left").remove()}),myApp.onPageAfterAnimation("signup",function(page){mainView.hideNavbar(),localStorage.getItem("user")&&($$('#signin-form input[name="username"]').val(localStorage.getItem("user")),$$('#signin-form input[name="password"]').val(localStorage.getItem("pass")),$$('#signin-form button[type="submit"]').click());var pageleft=$$(".page.page-on-left"),navbarleft=$$(".navbar-inner.navbar-on-left");mainView.history=[],(pageleft.length>0||navbarleft.length>0)&&(pageleft.remove(),navbarleft.remove())}),myApp.onPageInit("signup",function(page){$$("#link-signup").click(function(){mainView.router.load({template:Template7.templates.signupTemplate_A})}),$$("#signin-form").on("submit",function(event){event.preventDefault();var form_Login=myApp.formToJSON("#signin-form");PASSWORD=form_Login.password,USERNAME=form_Login.username,$$.post(api_url+"member/login",form_Login,function(data,status,xhr){mainView.history=[],setlogin(),myApp.mainView.router.loadPage("index.html"),mainView.showNavbar()})})}),$$("#logout").click(function(){setlogout(),mainView.router.load({template:Template7.templates.loginTemplate,animatePages:!1}),setTimeout(function(){mainView.history=[],$$(".page.page-on-left").remove(),$$(".navbar-inner.navbar-on-left").remove()},400)}),myApp.onPageInit("signup-form_A",function(page){mainView.showNavbar(),$$(".navbar-inner.fs1 .back").click(function(){mainView.router.load({template:Template7.templates.loginTemplate})}),(void 0!=formA||null!=formA)&&myApp.formFromJSON("#form_A",formA),$$(".next.fs_A").click(function(){formA=myApp.formToJSON("#form_A"),mainView.router.load({template:Template7.templates.signupTemplate_B})})}),myApp.onPageAfterAnimation("signup-form_A",function(){$$("#form_A fieldset").children("input").length,$$('#form_A input[type="tel"]').on("change",function(){phonenumber($$(this))}),$$('#form_A input[type="email"]').on("change",function(){validateEmail($$(this))}),$$('#form_A input[type="password"]').on("change",function(){checkPassword($$(this))}),$$('#form_A input[type="text"]').on("change",function(){checkName($$(this))})}),myApp.onPageInit("signup-form_B",function(page){(void 0!=formB||null!=formB)&&myApp.formFromJSON("#form_B",formB);myApp.calendar({input:"#calendar-birthday"});$$("span.radio label").click(function(){$$(this).find("input").prop("checked",!0)}),$$(".next.fs_B").click(function(){formB=myApp.formToJSON("#form_B"),mainView.router.load({template:Template7.templates.signupTemplate_C})}),$$(".previous.fs_B").click(function(){mainView.router.back()})}),myApp.onPageAfterAnimation("signup-form_B",function(){$$('#form_B input[type="text"] ').on("change",function(){checkName($$(this))})}),myApp.onPageInit("signup-form_C",function(page){(void 0!=formC||null!=formC)&&myApp.formFromJSON("#form_C",formC),$$(".previous.fs_C").click(function(){mainView.router.back()}),$$(".register-link").click(function(event){formC=myApp.formToJSON("#form_C");var formData={};$$.each(formA,function(i,j){formData[i]=j}),$$.each(formB,function(i,j){formData[i]=j}),$$.each(formC,function(i,j){formData[i]=j}),$$.post(api_url+"member/signup",formData,function(data){showMessage({content:"Thinks, register is Done"},2e3),mainView.router.load({template:Template7.templates.loginTemplate}),myApp.mainView.history=[]})})}),$$(document).on("pageAfterAnimation",function(e){var page=e.detail.page;$$(".contet-panel li a.link-"+page.name).addClass("disabled"),$$(".contet-panel li a:not(.link-"+page.name+")").removeClass("disabled")}),myApp.onPageInit("index",function(page){var indexHtml=Template7.templates.IndexTemplate(lang);$$(".indexBtns").html(indexHtml)}),myApp.onPageAfterAnimation("index",function(page){$$(".page.page-on-left").remove(),$$(".navbar-inner.navbar-on-left").remove(),getSlider()}),$$("a.link-profile").click(function(){mainView.router.load({template:Template7.templates.profileTemplate})}),myApp.onPageInit("profile",function(page){var profileData;$$.getJSON(api_url+"member/profile",function(data){profileData=data;var type="text";$$.each(data,function(i,v){switch(i){case"id":type="hidden";break;case"email":type="email";break;case"mobile":type="tel";break;case"birthdate":type="date";break;default:type="text"}var liitem='<li class="'+type+'-box"> <span class="table-30">'+i+'</span><span  class="table-70"> <input type="'+type+'" name="'+i+'" id="'+i+'" class="" value="'+v+'" readonly placeholder ="'+i+'"></span></li>';$$("#user_profile").append(liitem)})}),$$(".edit-profile").click(function(){$$('.profile-card input:not([type="email"])').removeAttr("readonly").toggleClass("editable"),$$(".btns-edit").toggleClass("hide");var liitem='<li class="password-box"> <span class="table-30">PASSWORD</span><span  class="table-70"> <input type="password" name="password" id="password" class=""  placeholder="Password" ></span></li>';0==$$(".password-box").length?$$("#user_profile").append(liitem):$$(".password-box").remove()}),$$(".btn-submit").click(function(){var profileform=myApp.formToJSON("#profileform");$$.post(api_url+"member/profile",profileform,function(){showMessage({content:lang.pro_updated},2e3)})}),$$(".btn-close").click(function(){myApp.formFromJSON("#profileform",profileData)})}),myApp.onPageInit("about",function(page){$$.getJSON(api_url+"misc/about",function(data){$$.each(data,function(i,v){$$("#aboutbox").html(v.description)})})});var placesTem=function(placeData){$$.each(placeData,function(i,address){var place=placeTemplate(address);$$("#myaddresses").prepend(place)}),myApp.hideProgressbar(),$$("a.link-edite").click(function(){var placeID=$$(this).parents(".card").attr("data-id");$$.each(placeData,function(i,address){address.adrs_id==placeID&&(addrssData=address)}),mainView.router.load({template:Template7.templates.placeform,context:{title:addrssData.adrs_title,id:addrssData.adrs_id}})})};myApp.onPageInit("places",function(page){myApp.showProgressbar("body","green"),user_adrs.length>0?placesTem(user_adrs):getAddresses(!0)}),myApp.onPageInit("form-page",function(page){myApp.formFromJSON(".addform",addrssData),$$(".addform .cancel-link").click(function(){myApp.formFromJSON(".addform",addrssData)}),$$(".addform .submit-link").click(function(e){e.preventDefault();var place_Data=myApp.formToJSON(".addform");$$.post(api_url+"member/address",place_Data,function(data){showMessage({content:lang.plc_updated},2e3),mainView.router.back(),$$("#myaddresses").html(" "),getAddresses(!0)})})}),myApp.onPageAfterAnimation("our-brunches",function(page){branches.length>0?$$.each(branches,function(i,item){var branchesList=branchTemplate(item);$$("#branchesList").append(branchesList),setTimeout(function(){myApp.swipeoutOpen($$("li.swipeout:first-child"))},500),setTimeout(function(){myApp.swipeoutClose($$("li.swipeout:first-child"))},2500)}):getBranches(!0),$$(".branches-list").on("click",".mark",function(){var x=$$(this).attr("data-latitude"),y=$$(this).attr("data-longitude");myApp.modal({text:'<div class="openMap"><a href="#" onclick="openMap('+x+","+y+');"><img src="img/Google-Maps-icon.png" alt=""><span>Open in Google map</span></a></div>',buttons:[{text:"Close"}]})})});var mySwiper;myApp.onPageInit("menu-list",function(page){$$("#menu-tabs").html(" "),0==Object.keys(menuCategories).length?menuList(!0):makeMenu(menuCategories),Scroll(),calculateBadge()}),myApp.onPageInit("cart",function(page){calculateBadge(),$$.each(menuCategories,function(i,category){$$.each(category.items,function(j,item){var cartList=cardTemplate(item);$$("#cartList").append(cartList)})}),myApp.swipeoutOpen($$("li.swipeout:first-child")),setTimeout(function(){myApp.swipeoutClose($$("li.swipeout:first-child"))},1500),$$("#cartList .countplus").click(function(){var pageName=mainView.activePage.name,card=$$(this).parents(".item-card"),cardId=card.attr("id");increaseCard(cardId,pageName),totalcart()}),$$("#cartList .countminus").click(function(){var pageName=mainView.activePage.name,card=$$(this).parents(".item-card"),cardId=card.attr("id");decreaseCard(cardId,pageName),totalcart()}),$$(".swipeout-delete").on("click",function(){var card=$$(this).parents(".item-card");removeCard(card.attr("id")),showCalculate(card),-1==myApp.mainView.history.indexOf("#content-1")&&mainView.router.refreshPreviousPage()}),$$(".swipeout").on("deleted",function(){calculateBadge(),totalcart()}),setTimeout(function(){totalcart(),total_cart=parseInt($$(".total-cart").text())},400),$$("li.swipeout").on("deleted",function(){setTimeout(function(){0==$$(".cart-list").children("li").length&&$$("a.btn-process").addClass("disabled")},400)}),$$(".btn-process").click(function(){mainView.router.load({template:Template7.templates.getorderTemplate})})}),$$(document).on("pageInit",'.page[data-page$="-place"]',function(e){selectBranch();var d=new Date,year=d.getFullYear()-1,day=d.getDate()-1,calendarInline=myApp.calendar({input:"#calendarinput",value:[new Date],weekHeader:!1,disabled:{from:new Date(year),to:new Date(d.getFullYear(),d.getMonth(),day)},cssClass:"branch_calender",toolbarTemplate:'<div class="toolbar calendar-custom-toolbar"><div class="toolbar-inner"><div class="left"><a href="#" class="link icon-only"><i class="icon icon_back"></i></a></div><div class="center"></div><div class="right"><a href="#" class="link icon-only"><i class="icon icon_forward"></i></a></div></div></div>',onOpen:function(p){$$(".calendar-custom-toolbar .center").text(monthNames[p.currentMonth]+", "+p.currentYear),$$(".calendar-custom-toolbar .left .link").on("click",function(){calendarInline.prevMonth()}),$$(".calendar-custom-toolbar .right .link").on("click",function(){calendarInline.nextMonth()})},onMonthYearChangeStart:function(p){$$(".calendar-custom-toolbar .center").text(monthNames[p.currentMonth]+", "+p.currentYear)},onDayClick:function(p,dayContainer,year,month,day){new Date(year,month,day);reqorder_date=year+"/"+(parseInt(month)+1)+"/"+day}}),d=new Date(calendarInline.value);reqorder_date=d.getFullYear()+"/"+(d.getMonth()+1)+"/"+d.getDate();var branchName,cardID,or_time,or_note;$$("#select_city select").change(function(){cardID=$$("#select_branch select").val(),branchName=$$("#select_branch select option[value='"+cardID+"']").text()}),$$("#select_branch select").change(function(){cardID=$$("#select_branch select").val(),branchName=$$("#select_branch select option[value='"+cardID+"']").text()}),$$('.input-time [type="time"]').on("focusout",function(){checkTime($$(this))}),or_time=$$("#order-time").val(),or_note=$$("#orderNote").val(),$$(".to-branch-cal .next.button").click(function(){if(or_time=$$("#order-time").val(),or_note=$$("#orderNote").val(),cardID=$$("#select_branch select").val(),getCurrentOrder(),""==!$$("#order-time").val())requestOrder(card_items,cardID,reqorder_date,or_time,or_note);else{var actionHtml=(lang.brch_req,[{text:lang.brch_req,label:!0,color:"red"}]);myApp.actions(actionHtml)}})}),myApp.onPageInit("myorders",function(page){getOrders()}),myApp.onPageInit("order-items",function(page){var ItemTemplate=temp("#order_items_template");$$.each(opj.details,function(i,item){var orItem=ItemTemplate(item);$$(".list-block.order_items ul").append(orItem)})}),myApp.onPageInit("yummy-list",function(page){getYummyList()}),myApp.init();
